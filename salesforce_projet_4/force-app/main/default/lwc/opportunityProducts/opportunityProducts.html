<template>
    <lightning-card title={label.opportunityProductsLabel} icon-name="standard:opportunity">
        <!-- Affiche le message d'avertissement si hasNegativeQuantity est vrai -->
        <template lwc:if={hasNegativeQuantity}>
            <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_warning warningStockText">
                <span class="slds-assistive-text">Warning</span>
                <lightning-formatted-rich-text value={label.lineQuantityProblem}></lightning-formatted-rich-text>
            </div>
        </template>

        <!-- Affiche le tableau si des produits sont disponibles -->
        <template lwc:if={hasProducts}>
            <lightning-datatable
                key-field="Id"
                data={products}
                columns={columns}
                draft-values={draftValues}
                oncellchange={handleCellChange} 
                onsave={handleSave} 
                onrowaction={handleRowAction}
                hide-checkbox-column>
            </lightning-datatable>
        </template>
        <template lwc:else>
            <div class="slds-box slds-theme_shade slds-theme_alert-texture ">
                <lightning-formatted-rich-text value={formattedLabel}></lightning-formatted-rich-text>
            </div>
        </template>
    </lightning-card>
</template>